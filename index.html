<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Senior Med Tracker</title>
    <link rel="stylesheet" href="styles.css?v=16">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1565C0">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%231565C0'><path d='M19 8h-2v3h-3v2h3v3h2v-3h3v-2h-3V8zM4 6h5v2H4V6zm0 4h5v2H4v-2zm0 4h5v2H4v-2z'/></svg>">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="screen active" aria-live="polite">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p>Loading...</p>
        </div>
    </div>

    <!-- Main Menu Screen - Today's Schedule -->
    <div id="main-menu" class="screen">
        <header class="main-header">
            <div class="header-content">
                <h1>Today's Medications</h1>
                <button id="settings-btn" class="icon-btn" aria-label="Settings">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97c0-.33-.03-.66-.07-1l1.86-1.41c.18-.14.23-.41.12-.61l-1.74-3.18c-.12-.23-.37-.3-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61L4.73 11c-.04.34-.07.67-.07 1s.03.65.07.97l-1.87 1.42c-.2.15-.25.42-.12.61l1.74 3.18c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.74-3.18c.12-.2.07-.46-.12-.61L19.43 13z"/>
                    </svg>
                </button>
            </div>
            <div class="date-display">
                <span id="current-date"></span>
            </div>
        </header>

        <main class="main-content">
            <div id="todays-schedule" class="schedule-container">
                <!-- Today's medication schedule will be populated here -->
            </div>

            <div class="action-grid">
                <button id="add-med-btn" class="action-card primary" aria-describedby="add-med-help">
                    <div class="action-icon">+</div>
                    <div class="action-text">Add Medication</div>
                </button>
                
                <button id="upcoming-schedule-btn" class="action-card" aria-describedby="upcoming-help">
                    <div class="action-icon">üìÖ</div>
                    <div class="action-text">Weekly View</div>
                </button>
                
                <button id="view-history-btn" class="action-card" aria-describedby="history-help">
                    <div class="action-icon">üìä</div>
                    <div class="action-text">History</div>
                </button>
                
                <button id="manage-meds-btn" class="action-card" aria-describedby="manage-help">
                    <div class="action-icon">üíä</div>
                    <div class="action-text">Manage</div>
                </button>
            </div>
        </main>
    </div>

    <!-- Add Medication Screen -->
    <div id="add-medication" class="screen">
        <header class="app-header">
            <button id="back-from-add" class="back-btn" aria-label="Go back to main menu">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                </svg>
                Back
            </button>
            <h1>Add Medication</h1>
        </header>

        <main class="main-content">
            <form id="medication-form" class="med-form">
                <div class="form-group">
                    <label for="med-name" class="form-label">Medication Name *</label>
                    <input type="text" id="med-name" class="form-input" required aria-describedby="name-help">
                    <p id="name-help" class="help-text">Enter the name of your medication</p>
                </div>

                <div class="form-group">
                    <label for="med-dosage" class="form-label">Dosage</label>
                    <input type="text" id="med-dosage" class="form-input" placeholder="e.g., 10mg" aria-describedby="dosage-help">
                    <p id="dosage-help" class="help-text">Optional: Enter the dosage amount</p>
                </div>

                <div class="form-group">
                    <label for="med-times" class="form-label">Times per Day *</label>
                    <select id="med-times" class="form-select" required aria-describedby="times-help">
                        <option value="">Select times per day</option>
                        <option value="1">Once daily</option>
                        <option value="2">Twice daily</option>
                        <option value="3">Three times daily</option>
                        <option value="4">Four times daily</option>
                    </select>
                    <p id="times-help" class="help-text">How many times per day do you take this medication?</p>
                </div>

                <div id="time-slots" class="time-slots">
                    <!-- Time inputs will be added dynamically -->
                </div>

                <div class="form-actions">
                    <button type="submit" class="primary-btn">
                        <span class="btn-icon" aria-hidden="true">‚úÖ</span>
                        Save Medication
                    </button>
                    <button type="button" id="cancel-add" class="secondary-btn">
                        <span class="btn-icon" aria-hidden="true">‚ùå</span>
                        Cancel
                    </button>
                </div>
            </form>
        </main>
    </div>

    <!-- Upcoming Schedule Screen -->
    <div id="upcoming-schedule" class="screen">
        <header class="sub-header">
            <button id="back-from-upcoming" class="back-btn" aria-label="Back">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                </svg>
            </button>
            <h1>Weekly Schedule</h1>
            <div></div>
        </header>

        <main class="main-content">
            <div class="schedule-intro">
                <p style="font-size: var(--body-font-size); color: var(--text-color); text-align: center; margin-bottom: var(--spacing-lg); opacity: 0.8;">
                    See your medications for each day of the week
                </p>
            </div>
            
            <div class="week-navigation">
                <div id="week-display" class="week-display">This Week</div>
                <div class="week-nav-buttons">
                    <button id="prev-week" class="week-nav-btn" aria-label="Previous week">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                            <path d="M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"/>
                        </svg>
                        Previous
                    </button>
                    <button id="next-week" class="week-nav-btn" aria-label="Next week">
                        Next
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                            <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <div id="weekly-schedule" class="weekly-schedule">
                <!-- Daily cards will be populated here -->
            </div>
        </main>
    </div>

    <!-- History Screen -->
    <div id="history" class="screen">
        <header class="app-header">
            <button id="back-from-history" class="back-btn" aria-label="Go back to main menu">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                </svg>
                Back
            </button>
            <h1>Medication History</h1>
        </header>

        <main class="main-content">
            <div id="history-list" class="history-container">
                <!-- History entries will be populated here -->
            </div>
        </main>
    </div>

    <!-- Settings Screen -->
    <div id="settings" class="screen">
        <header class="app-header">
            <button id="back-from-settings" class="back-btn" aria-label="Go back to main menu">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                </svg>
                Back
            </button>
            <h1>Settings</h1>
        </header>

        <main class="main-content">
            <div class="settings-section">
                <h2>Notification Settings</h2>
                
                <div class="setting-item">
                    <label class="setting-label">
                        <input type="checkbox" id="sound-enabled" class="setting-checkbox">
                        <span class="setting-text">Enable Sound</span>
                    </label>
                    <p class="help-text">Play a sound when reminders appear</p>
                </div>

                <div class="setting-item">
                    <label class="setting-label">
                        <input type="checkbox" id="vibration-enabled" class="setting-checkbox">
                        <span class="setting-text">Enable Vibration</span>
                    </label>
                    <p class="help-text">Vibrate device for reminders</p>
                </div>
            </div>

            <div class="settings-section">
                <h2>Display Settings</h2>
                
                <div class="setting-item">
                    <label class="setting-label">
                        <input type="checkbox" id="high-contrast" class="setting-checkbox">
                        <span class="setting-text">High Contrast Mode</span>
                    </label>
                    <p class="help-text">Increase contrast for better visibility</p>
                </div>

                <div class="setting-item">
                    <label for="text-size" class="setting-label">Text Size</label>
                    <select id="text-size" class="form-select">
                        <option value="normal">Normal</option>
                        <option value="large">Large</option>
                        <option value="extra-large">Extra Large</option>
                    </select>
                    <p class="help-text">Adjust text size for comfort</p>
                </div>
            </div>

            <div class="settings-section">
                <h2>Data Management</h2>
                
                <button id="export-data" class="secondary-btn">
                    <span class="btn-icon" aria-hidden="true">üì§</span>
                    Export Data
                </button>
                <p class="help-text">Download your medication data</p>

                <button id="import-data" class="secondary-btn">
                    <span class="btn-icon" aria-hidden="true">üì•</span>
                    Import Data
                </button>
                <p class="help-text">Load medication data from a file</p>
                <input type="file" id="import-file" accept=".json" style="display: none;">

                <button id="clear-data" class="danger-btn">
                    <span class="btn-icon" aria-hidden="true">üóëÔ∏è</span>
                    Clear All Data
                </button>
                <p class="help-text">Delete all medications and history</p>
            </div>
        </main>
    </div>

    <!-- Notification Permission Modal -->
    <div id="notification-modal" class="modal" role="dialog" aria-labelledby="modal-title" aria-hidden="true">
        <div class="modal-content">
            <h2 id="modal-title">Enable Notifications</h2>
            <p>To receive medication reminders, please allow notifications for this app.</p>
            <div class="modal-actions">
                <button id="enable-notifications" class="primary-btn">Enable Notifications</button>
                <button id="skip-notifications" class="secondary-btn">Skip for Now</button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="modal" role="dialog" aria-labelledby="confirm-title" aria-hidden="true">
        <div class="modal-content">
            <h2 id="confirm-title">Confirm Action</h2>
            <p id="confirm-message"></p>
            <div class="modal-actions">
                <button id="confirm-yes" class="primary-btn">Yes</button>
                <button id="confirm-no" class="secondary-btn">No</button>
            </div>
        </div>
    </div>

    <!-- Alert/Toast Messages -->
    <div id="toast" class="toast" role="alert" aria-live="assertive" aria-hidden="true"></div>

    <!-- Hidden Help Text for Screen Readers -->
    <div id="add-med-help" class="sr-only">Tap to add a new medication with reminders</div>
    <div id="upcoming-help" class="sr-only">View your medication schedule for the upcoming week</div>
    <div id="history-help" class="sr-only">View your medication history and records</div>
    <div id="manage-help" class="sr-only">Manage your existing medications</div>

    <script src="script.js?v=16"></script>
</body>
</html>
